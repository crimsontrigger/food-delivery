<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        <title>Admin Site</title>
        <link type="image/png" rel="icon" href="../static/food.png">
        <!-- BOOTSTRAP -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">        
    </head>
    <body>
        <div class="container">
            <div class="row">
                <div class="container" id="table-container">
                    <table class="table" id="admin-table"><tr><th>MESS</th><th>Total Price</th><th>Recipient</th><th>Address</th><th>Phone</th><th>Payment Mode</th><th></th><th>Payment(UPI) ID</th><th>ITEMS</th></tr></table>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-6">
                    <!-- Container for Number of Orders -->
                </div>
                <div class="col-lg-6">
                    <!-- Container for total revenue generated -->
                </div>
            </div>
        </div>
        <!-- Scripts related to BOOTSTRAP -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
        <link href='../static/styles.css' rel="stylesheet">
        <script>
            //JS FOR ADMIN PAGE
            const server="http://ec2-13-232-249-4.ap-south-1.compute.amazonaws.com"; //CHANGE THIS
            console.log("ADMIN SCRIPT RUNNING");
            $.ajaxSetup({
                contentType: "application/json; charset=utf-8"
            });
            let items = {};
            let orders = {};
            let request = {'command':'database_request'}
            request = JSON.stringify(request);
            $(document).ready(function() {
                console.log('Document is Ready');
                $.ajax({
                    url: server,
                    type: 'POST',
                    dataType: 'json',
                    data: request,
                    success: function(msg) {
                        console.log('success on admin site');
                        orders = msg.items; //msg = {"items":[[id,name,room,phone,payment_mode,payment_id,items],[id,name,room,phone,payment_mode,payment_id,items]]}
<<<<<<< HEAD
                        let string = "";
                        for(let i=0;i<orders.length;++i) {
                            console.log(orders[i]);
                            // $('<tr><td>'+orders[i][0]+'</td>'+'<td>'+orders[i][1]+'</td>'+'<td>'+orders[i][2]+'</td></tr>');
                            // for(let j=0;j<)

=======

                        for(let i=0;i<orders.length;++i) {
                            console.log(orders[i]);
                            // $('<tr><td>'+orders[i][0]+'</td>'+'<td>'+orders[i][1]+'</td>'+'<td>'+orders[i][2]+'</td></tr>');
                            let initial = "<tr>";
                            let string = initial;
                            let j;
                            for(j=0;j<orders[i].length;++j) {
                                string+= "<td>"+orders[i][j]+"</td>";
                                console.log(string);

                                if(j==7) {
                                    string+="<td>";
                                    for(const [key,value] of Object.entries(orders[i][7])) {
                                        console.log("ORDERS ARE HERE: ",orders[i][7],key,value);
                                        if(key===null && value===null) {
                                            string+='';
                                            continue;
                                        }
                                        string+='<div class="entries">'+key+': <strong>'+value+'</strong>: '+'</div>';
                                        console.log(string);
                                    }
                                    string+="</td>";
                                }
                            }
                            $(string).appendTo('#admin-table');

                            let final="</tr>";
                            string+=final;
                            console.log(string);
>>>>>>> upstream/master
                        }
                    }
                });
            });
        </script>
    </body>
</html>
